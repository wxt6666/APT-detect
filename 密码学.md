1. 差分分析      30 不涉及算法 只有小demo，cipherfour算法，换密钥，s核 
2. 线性分析     25 
3. 哈希的安全性   15  一个文件
4. 中间相遇攻击    15 一个文件
5. 积分攻击。   15 一个文件

## 提纲

### （1）差分分析 5 [30]

选择明文攻击

换了攻击组件：密钥生成算法换了/S盒
分组长度16/密钥长度16/32
最后一轮没有P置换？



差分攻击的主要思想：
长轮数的高概率差分路线(PPT)
密钥恢复=>怎么手动找，展开讲哦
PPT是密钥恢复的一般步骤

寻找路线：
1. 找高概率 扩展
2. 看活跃S盒个数

如何发现高概率差分：
线性组件：概率为1通过
非线性组件：

差分分布表的构建伪代码，会看；
寻找差分路线；[根据DDT找全轮最优/次优]

最优的四轮差分？
差分迭代特征

分组长度和轮数的关系？

密钥恢复攻击：（平时作业）每一轮秘钥是相关的，使用区分器做密钥恢复攻击
HOW：怎么放区分器，放多少明密文对，采用的数据量，时间复杂度需要给定；=>去网上找
数据量使用： 2/P P= 概率（PPT） 尾部差分确定格式

多比特恢复如何设计密钥恢复阶段的S盒和计数器

数据复杂度 时间复杂度 存储复杂度 （PPT）
明文需要的数据量 明文对需要2/P；需要明文空间是多少
时间复杂度：加密时间（全轮加密）时间成本是明文加密=>（4bit）一个盒的解密时间=1/4全轮 在CipherFour中是1/4*1/5
计数器占据的空间（比特数）转成字节

时间复杂度不能超过全轮加密时间 （穷搜时间）
存储复杂度上界：2^16

取小值

### （2）线性分析 5 [25]

已知明文攻击

需要的复杂度更少
线性是主要考虑线性掩码的传播;区别与差分攻击是差分的传播

目的：明文比特和密文比特一些位置异或一下，结果再异或看看==1 or ==0 看看概率偏离1/2的长度

alpha · p ^ beta · c = 0
按位乘，结果按比特异或（点乘）

恢复算法1
听不懂 看PPT吧
还是要看的，给定的参数

关键在于掩码的寻找 => LAT

跨两层：6-2

堆积引理的描述 堆积引理算总偏差

算法2 掌握：
r+1轮秘钥恢复

一般攻击过程（PPT）标准的
 N数据集复杂度 = 姨婆森隆平方分之一， 姨婆森隆是偏差
 姨婆森隆 = P - 1/2

 LAT的伪代码 存的是偏差不是概率

 负的表示出现1的个数多 正的表示0的个数多 (LAT 会看)

 二轮的LAT路线：
 看成立的偏差 P 堆积引理计算

 4轮区分器做五轮恢复秘钥攻击；
 线性逼近表达式



### （3）哈希的安全性 3 [15]

只考理论

哈希函数的定义

哈希函数做什么的

哈希函数的性质：任意长度=>固定长度的散列值;快速计算；消息不同，散列值不同；

三个安全属性：抗原像（O(2^l)），抗第二原像一样，抗碰撞（O（2^l/2））

MD模式：弱点：有消息扩展攻击：加一块消息和原来F做运算产生散列值，危害：可以加附件
弱点2：两块消息的碰撞，中间碰撞了之后后面都是一样的=>危害：改头部，产生碰撞

MD模式的结构弱点：

碰撞攻击，如果两个不同的消息产生相同的哈希值，这就是一个碰撞。攻击者可以有意地构造两个不同的消息，但具有相同的哈希值，这可能会导致安全问题，特别是在数字签名和证书颁发机构等应用中。
消息扩展攻击：在该攻击中，攻击者可以利用已知哈希值和消息的部分内容来生成扩展消息，而无需知道密钥，攻击者可以在已知哈希值后附加自己的数据块，然后重新计算哈希。

应用：伪造MAC

叙述DM模式Davies Meyer F函数的设计

PPT

### （4）中间相遇攻击 3 [15]

不是只考理论

两个阶段：1.中间相遇阶段 2.暴力穷搜阶段
给定一些参数，分组长度，密钥长度，中间相遇的点什么的

MITM阶段：PPT A simple ruru

复杂度计算 A0 A1 A2 取大的三者
时间复杂度 
数据复杂度
存储复杂度


这块找博主看看吧


CipherFour的中间相遇攻击

### （5）积分攻击 3 [15]

找到算法的积分路线，在积分路线的基础上做密钥恢复攻击

How最优区分器，细化每个区分器上积分的传播

Feistel结构 SPN结构 

选择明文攻击

PPT  平衡的（传播规律）

积分攻击的一般思想

Square攻击的基本过程

发现长轮数的积分区分器
根据区分器 选择明文集合 获得密文集合
猜测密文区分器头尾需要的秘钥 验证是否满足区分器的集合特征 不满足则是错误 
重复



## 考点：

### 差分部分

选择明文攻击
差分分析主要思想：通过选择满足特定差分的明文对，追踪差分在多轮加密过程中的 变换情况（1）发现长轮数的高概率差分 (2) 推测从密文解密到∆out的密钥信息，建立针对密钥某些比特的差分区分器。

一般步骤：
会看差分分布表？给差分表，S盒？找最优路线
时间复杂度:（1）加密消息的时间，即明文量（2）组对，去噪的时间（3）求解密钥的时间
数据复杂度：
存储复杂度：

- CIPHERFOUR S盒 变 T置换不变
- 最后一轮无T置换
- 主要思想不能只写两条 -找一个高概率差分路线 等 详细展开讲
- 先要求S盒尽可能少，从少到多找路线
- 秘钥恢复阶段：
- 如何发现高概率差分-重点
- 会查差分分布表
- 怎么找差分路线 PPT
- 分析复杂度 时间空间



### 线性部分

线性攻击是已知明文攻击
线性掩码的传播规则：（1）异或运算: （2）分支运算：
（3）线性映射：
堆积引理叙述、计算
算法二的描述
线性分析密钥恢复攻击的过程
复杂度分析
偏差在各个组件的传播规律（线性组件不变，非线性组件满足堆积引理）
最优路线查找

- 堆积引理会描述 不用证明
- 偏差看得懂 行列
- 线性攻击一般步骤
- 表构造 用
- 最优线性路线构造
- 线性偏差计算
- 秘钥恢复攻击 - 不用找4-5轮 越多轮越好

### 哈希函数

什么是哈希函数
哈希函数的应用：
哈希函数特性：
抗原像攻击（单向性）：
抗碰撞攻击（抗强碰撞性）：
MD模式的结构弱点：碰撞攻击，如果两个不同的消息产生相同的哈希值，这就是一个碰撞。攻击者可以有意地构造两个不同的消息，但具有相同的哈希值，这可能会导致安全问题，特别是在数字签名和证书颁发机构等应用中。
消息扩展攻击：在该攻击中，攻击者可以利用已知哈希值和消息的部分内容来生成扩展消息，而无需知道密钥，攻击者可以在已知哈希值后附加自己的数据块，然后重新计算哈希。



- hash函数定义、做什么事
- 安全属性- 抗原项攻击、第二原箱 抗碰撞 和描述
- Merkle-Damgard mode  两个弱点 选一 个 
- md5 



### 中间相遇攻击：

描述两个阶段
中间相遇阶段
暴力求出阶段、
复杂度计算 
时间复杂度 
数据复杂度
存储复杂度

### 积分攻击





### 差分分析

![image-20230613093801402](https://s2.loli.net/2023/06/13/YNAXqIx6JDagElz.png)

差分目的：消除密钥影响

S盒为非线性计算





三个复杂度 







哈希的安全性

哈希的定义：将任意长度的消息（message）压缩成固定长度的散列值（hash value）

哈希的性质：3个

1. 可以将任意长度的消息压缩成固定长度的散列值
2. 可以快速计算散列值
3. 消息不同，散列值不同

安全属性：3个

1. 抗原像攻击（单向性），对任意的h计算H(y) = h是不可行的
2. 抗第二原像攻击（抗弱碰撞性），对任意的x，找到满足于H(x) = H(y) 是不可行的
3. 抗碰撞攻击（抗强碰撞性），找到满足H(x) = H(y) 的 (x, y) 是不可行的

应用：

1. 一次性口令
2. 伪随机数生成
3. 基于口令加密PBE
4. 消息认证
5. 数字签名
6. 软件是否被篡改

碰撞攻击，如果两个不同的消息产生相同的哈希值，这就是一个碰撞。攻击者可以有意地构造两个不同的消息，但具有相同的哈希值，这可能会导致安全问题，特别是在数字签名和证书颁发机构等应用中。
消息扩展攻击：在该攻击中，攻击者可以利用已知哈希值和消息的部分内容来生成扩展消息，而无需知道密钥，攻击者可以在已知哈希值后附加自己的数据块，然后重新计算哈希。

DM弱点

1. 碰撞攻击，如果两个不同的消息得到了同样的哈希值，这就是碰撞。攻击者可以有意的创造两个不同的消息产生相同的哈希值，这可能会导致安全问题，特别是在数字签名和证书颁发机构等应用中。
2. 消息传递攻击，攻击者可以通过已知的哈希值和消息的部分内容来生成扩展消息，而无需知道密钥，攻击者可以在已知哈希值之后附加自己的数据块，然后重新计算哈希值。







差分分析————————————————————
原理：依据输入差分和输出差分的高概率匹配（不随机现象）

c=m⊕k =>(m1⊕k)⊕(m2⊕k)=m1⊕m2=c1⊕c2

一轮加密：
m⊕k0=u,S(u)=v,v⊕k1=c
m1⊕m2=u1⊕u2
S(u1)⊕S(u2)=c1⊕c2
根据输入差分和输入差分的对应，可由输出差分c2-c1根据差分分布表得到u1,由m2-m1可得到得到输入差分u2-u1再得k0

破解：找到最优路径，输入相应符合输入差分的 明文和密文对，遍历密钥所有可能并计数

线性分析——————————————————

哈希攻击——————————————————
定义：将任意长的消息（message）压缩为一个固定长度的摘要（hash value）
性质：1.根据任意长度的消息计算出固定长度的散列值
     2.能够快速计算出散列值
     3.消息不同散列值也不同
安全需求：
抗原像攻击（单向性） 对任意的 h，计算 H(y) = h 的 y 在计算上是不可行的
抗第二原像攻击（抗弱碰撞性） 对任意的 x，找到满足 H(x) = H(y) 的 y 在计算上是不可行的
抗碰撞攻击（抗强碰撞性） 找到满足 H(x) = H(y) 的 (x,y) 在计算上是不可行的
应用：
检测软件是否被篡改
基于口令的加密（PBE）
消息认证码
数字签名
伪随机数生成器
一次性口令
MD5模式的两个弱点：
消息扩展攻击：攻击者知道M的长度和MD5(M)，通过扩展的方式继续计算MD5值，即知道加密过程的某一MD5值，即可伪造最后的MD5值
F函数碰撞：尝试不同的输入，使得2次加密和3次加密的MD5值可能相同，即尝试出某一值和明文的不同次数加密结果相同，即可替代明文获得最后的MD5值

中间相遇攻击——————————
双重DES加密：C=Ek2(Ek1(P)),Ek1(P)=x,Ek2(x)=C
已知明密文对(P,C)，1.穷举K1用DES加密P，得到所有值，生成表L，2.穷举K2用DES解密C，每次得到的值与表L比较。若相等则换明密文继续测试。
时间复杂度：穷举K1->O(n)，穷举k2从Ek1(P)中查找->O(log2n)，总->O(nlog2n)
空间复杂度：2^|Kf|+2^|Kb|+2^|K-m|，|K-m|穷举

积分攻击————————
 原理：
1.一系列状态的取值求（异或）和
2.通过选择满足某种特性的明文集合，追踪该集合特性在多轮加密过程中的传播情况，通过i轮之后集合特性的不随机现象将一个密码算法与随机置换区分开
3.只要算法采用的变换是双射，与算法部件的具体取值关系不大
集合特性：
活跃集：集合中每个元素不相同
稳定集：集合中每个元素都相同
平衡集：集合中所有元素异或为0

　
